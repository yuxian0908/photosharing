angular.module("users",["ngFileUpload"]),angular.module("users").factory("Authentication",[function(){return this.user=window.user,{user:this.user}}]),angular.module("users").directive("ngFileSelect",["fileReader","$timeout",function(e,n){return{scope:{ngModel:"="},link:function(o,t){function r(t){e.readAsDataUrl(t,o).then(function(e){n(function(){o.ngModel=e})})}t.bind("change",function(e){r((e.srcElement||e.target).files[0])})}}}]),angular.module("users").factory("fileReader",["$q","$log",function(e,n){var o=function(e,n,o){return function(){o.$apply(function(){n.resolve(e.result)})}},t=function(e,n,o){return function(){o.$apply(function(){n.reject(e.result)})}},r=function(e,n){return function(e){n.$broadcast("fileProgress",{total:e.total,loaded:e.loaded})}},a=function(e,n){var a=new FileReader;return a.onload=o(a,e,n),a.onerror=t(a,e,n),a.onprogress=r(0,n),a};return{readAsDataUrl:function(n,o){var t=e.defer();return a(t,o).readAsDataURL(n),t.promise}}}]),angular.module("users").config(["$routeProvider","$locationProvider",function(e,n){e.when("/_admin",{templateUrl:"users/views/users.client.view.html"}).when("/_admin/signin",{templateUrl:"users/views/usersSignin.client.view.html"}).when("/_admin/signup",{templateUrl:"users/views/usersSignup.client.view.html"}).when("/_admin/signout",{templateUrl:"users/views/usersSignout.client.view.html"}).otherwise({redirectTo:"/"}),n.html5Mode(!0)}]),angular.module("users").controller("UsersController",["$scope","Authentication","$location","$routeParams","$http","fileReader","Upload","$window",function(e,n,o,t,r,a,s,i){e.authentication=n,e.signin=function(){var n={username:this.username,password:this.password};r.post("api/_admin/signin",n).then(function(e){window.location.reload("/_admin"),o.path("/_admin")},function(n){e.error=errorResponse.data.message})},e.signout=function(){var n={firstname:this.firstname,lastname:this.lastname,email:this.email,username:this.username,password:this.password};r.post("api/_admin/signout",n).then(function(e){window.location.reload("/_admin"),o.path("/_admin")},function(n){e.error=errorResponse.data.message})},e.signup=function(){var n={firstname:this.firstname,lastname:this.lastname,email:this.email,username:this.username,password:this.password};r.post("api/_admin/signup",n).then(function(e){window.location.reload("/_admin"),o.path("/_admin")},function(n){e.error=errorResponse.data.message})},e.uploadptos={init:function(){e.uploadptos.imageSrc="",e.uploadptos.showupload=!0,console.log(e.uploadptos.showupload)}},e.$on("fileProgress",function(n,o){console.log(e.imageSrc),e.progress=o.loaded/o.total});var u=this;u.submit=function(){u.upload_form.file.$valid&&u.file&&u.upload(u.file)},u.upload=function(e){s.upload({url:"/api/_admin/upload",data:{file:e}}).then(function(e){0===e.data.error_code?i.alert("Success "+e.config.data.file.name+"uploaded. Response: "):i.alert("an error occured")},function(e){console.log("Error status: "+e.status),i.alert("Error status: "+e.status)},function(e){console.log(e);var n=parseInt(100*e.loaded/e.total);console.log("progress: "+n+"% "+e.config.data.file.name),u.progress="progress: "+n+"% "})}}]);